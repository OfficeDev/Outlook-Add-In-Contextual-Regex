---
page_type: sample
products:
- office-365
- office-outlook
languages:
- javascript
extensions:
  contentType: samples
  technologies:
  - Add-ins
  createdDate: 1/11/2018 1:18:43 PM
---
# Надстройка Outlook: Номер заказа Contoso

В этом примере надстройки показано, как создать [Контекстуальную надстройку](https://docs.microsoft.com/en-us/outlook/add-ins/contextual-outlook-add-ins), которая активируется, если в тексте сообщения обнаружено сопоставление регулярных выражений.

Надстройка обнаруживает фиктивные номера заказов Contoso в определенном формате. Используется формат `CO-`, за которым следуют 9 цифр. При активизации надстройки выводится только выбранный номер заказа и список всех обнаруженных номеров заказов.

> **Примечание:** Получение выбранного номера заказа зависит от API, который в настоящее время находится в режиме предварительного просмотра, поэтому он может быть доступен не для всех клиентов. Если это не так, надстройка сообщит о том, что она не поддерживается.

## Предварительные требования

Чтобы испытать эту надстройку, вам потребуются следующие возможности:

- Office 365: Если у вас еще нет Office 365, вы можете [зарегистрировать бесплатную](http://office.microsoft.com/en-us/try/?WT%2Eintid1=ODC%5FENUS%5FFX101785584%5FXT104056786)пробную подписку на 1 месяц.
- Защищенный SSL веб-сервер: Это может быть веб-сервер с SSL-сертификатом, который является надежным для вашего клиента. Если у вас нет доступа к веб-серверу, см. раздел [Запуск надстройки локально](running-locally.md) для инструкции по запуску базового веб-сервера из командной строки с помощью узла Node.js и NPM.

## Настроить надстройку

1. Если вы не собираетесь запускать надстройку локально, скопируйте файлы HTML, CSS, JavaScript и PNG из проекта на веб-сервер, сохраняя ту же структуру каталогов.
1. Откройте манифест (`contoso-order-number-manifest.xml`) в текстовом редакторе и замените все случаи `https://localhost:8080` на URL-адрес каталога, в который вы скопировали файлы в предыдущем действии.
1. Убедитесь, что вы можете просматривать обновленные URL-адреса в манифесте с помощью клиента с помощью браузера. Например, вы должны иметь возможность перейти по URL-адресу в элементе `<bt:Url id="detectedEntityURL">` в манифесте и увидеть следующую страницу:

    ![Снимок экрана: index.html страница надстройки, загружена в браузер](readme-images/browse-to-add-in.PNG)

## Загрузка неопубликованной надстройки

Следуйте инструкциям, приведенным на странице [Загрузка неопубликованных надстроек Outlook для тестирования](https://docs.microsoft.com/en-us/outlook/add-ins/sideload-outlook-add-ins-for-testing), чтобы загрузить файл`contoso-order-number-manifest.xml`.

## Попробуйте

1. Откройте [Outlook в Интернете](https://outlook.office.com).
1. Отправьте себе сообщение с номером заказа Contoso в тексте сообщения. Например:

    ```
    Thanks for your order! Your order number is CO-123456789.
    ```
1. Когда сообщение поступает в папку "Входящие", откройте его. Номер заказа должен быть выделен. Щелкните номер заказа, чтобы открыть надстройку.

    ![Снимок экрана: надстройка, активизированная в Outlook в Интернете](readme-images/add-in-activated.PNG)

## Помощь

Мы всегда рады предложениям и помощи в работе над проектом.
Обычно для добавления своих вариантов необходимо принять Лицензионное соглашение с участником (CLA), заявив, что вы имеете право предоставлять и предоставляете нам права на использование своего варианта.
Подробности см. на сайте https://cla.microsoft.com.

Когда вы будете отправлять запрос на вытягивание, CLA-бот автоматически определит, нужно ли вам предоставить CLA и соответствующим образом изменит внешний вид запроса на вытягивание (например, добавит метку, комментарий).
Просто следуйте инструкциям бота.
Вам нужно будет сделать это только один раз во всех репозиториях, используя наш CLA.

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/).
Дополнительные сведения см. в разделе [Часто задаваемые вопросы о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/).
Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## Авторские права

(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.